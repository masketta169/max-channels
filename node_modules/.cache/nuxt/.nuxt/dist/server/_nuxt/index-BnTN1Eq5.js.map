{"version":3,"file":"index-BnTN1Eq5.js","sources":["../../../../../../../services/api/auth.ts","../../../../../../../utils/cookies.ts","../../../../../../../services/api/index.ts"],"sourcesContent":["import api from './index';\nimport type { AuthResponse, User } from '@/types/api/auth';\n\nexport const authService = {\n  register: (email: string, password: string) =>\n    api.post<AuthResponse>('/auth/register', { email, password }),\n\n  login: (email: string, password: string) =>\n    api.post<AuthResponse>('/auth/login', { email, password }),\n\n  refresh: () =>\n    api.post<AuthResponse>('/auth/refresh'),\n\n  logout: () =>\n    api.post<void>('/auth/logout'),\n};\n","// –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å cookies\nexport const getCookie = (name: string): string | null => {\n    if (typeof document === 'undefined') return null // –î–ª—è SSR\n    const value = `; ${document.cookie}`\n    const parts = value.split(`; ${name}=`)\n    if (parts.length === 2) return parts.pop()?.split(';').shift() || null\n    return null\n}\n\nexport const setCookie = (name: string, value: string, days = 7): void => {\n    if (typeof document === 'undefined') return\n    const date = new Date()\n    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000))\n    document.cookie = `${name}=${value};expires=${date.toUTCString()};path=/`\n}","import axios, { type AxiosRequestHeaders } from 'axios';\nimport { authService } from './auth';\nimport { getCookie, setCookie } from '@/utils/cookies'\n\nconst api = axios.create({\n  baseURL: 'http://localhost:3001/api', \n  withCredentials: true,\n});\n\n// --- 1. –ü–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω ---\napi.interceptors.request.use((config) => {\n  const token = getCookie('accessToken');\n  if (token) {\n    if (!config.headers) {\n\n      config.headers = {} as AxiosRequestHeaders;\n    }\n    config.headers['Authorization'] = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// --- 2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã ---\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    console.log('response error', error?.response?.status);\n\n    if (error.response?.status === 401) {\n      const refreshToken = getCookie('refreshToken');\n      if (refreshToken) {\n        try {\n          // –ø—Ä–æ–±—É–µ–º –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω\n          const response = await authService.refresh();\n          setCookie('accessToken', response.data.accessToken);\n\n          // üîÅ –ø–æ–≤—Ç–æ—Ä—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º\n          error.config.headers['Authorization'] = `Bearer ${response.data.accessToken}`;\n          return api.request(error.config);\n        } catch (err) {\n          console.error('Refresh token failed:', err);\n          // —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–≥–∏–Ω, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ\n        }\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\nexport default api;\n"],"names":[],"mappings":";AAGO,MAAM,cAAc;AAAA,EACzB,UAAU,CAAC,OAAe,aACxB,IAAI,KAAmB,kBAAkB,EAAE,OAAO,UAAU;AAAA,EAE9D,OAAO,CAAC,OAAe,aACrB,IAAI,KAAmB,eAAe,EAAE,OAAO,UAAU;AAAA,EAE3D,SAAS,MACP,IAAI,KAAmB,eAAe;AAAA,EAExC,QAAQ,MACN,IAAI,KAAW,cAAc;AACjC;ACdO,MAAM,YAAY,CAAC,SAAgC;AACjB,SAAO;AAKhD;AAEO,MAAM,YAAY,CAAC,MAAc,OAAe,OAAO,MAAY;AACjC;AAIzC;ACVA,MAAM,MAAM,MAAM,OAAO;AAAA,EACvB,SAAS;AAAA,EACT,iBAAiB;AACnB,CAAC;AAGD,IAAI,aAAa,QAAQ,IAAI,CAAC,WAAW;AACvC,QAAM,QAAQ,UAAuB;AACrC,MAAI,OAAO;AACT,QAAI,CAAC,OAAO,SAAS;AAEnB,aAAO,UAAU,CAAA;AAAA,IACnB;AACA,WAAO,QAAQ,eAAe,IAAI,UAAU,KAAK;AAAA,EACnD;AACA,SAAO;AACT,CAAC;AAGD,IAAI,aAAa,SAAS;AAAA,EACxB,CAAC,aAAa;AAAA,EACd,OAAO,UAAU;AACf,YAAQ,IAAI,kBAAkB,OAAO,UAAU,MAAM;AAErD,QAAI,MAAM,UAAU,WAAW,KAAK;AAClC,YAAM,eAAe,UAAwB;AAC7C,UAAI,cAAc;AAChB,YAAI;AAEF,gBAAM,WAAW,MAAM,YAAY,QAAA;AACnC,oBAAU,eAAe,SAAS,KAAK,WAAW;AAGlD,gBAAM,OAAO,QAAQ,eAAe,IAAI,UAAU,SAAS,KAAK,WAAW;AAC3E,iBAAO,IAAI,QAAQ,MAAM,MAAM;AAAA,QACjC,SAAS,KAAK;AACZ,kBAAQ,MAAM,yBAAyB,GAAG;AAAA,QAE5C;AAAA,MACF;AAAA,IACF;AAEA,WAAO,QAAQ,OAAO,KAAK;AAAA,EAC7B;AACF;"}