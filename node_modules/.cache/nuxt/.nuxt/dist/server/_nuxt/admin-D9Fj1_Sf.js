import { jwtDecode } from "jwt-decode";
import { d as defineNuxtRouteMiddleware, e as useRequestEvent, n as navigateTo } from "../server.mjs";
import "vue";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/klona/dist/index.mjs";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/hookable/dist/index.mjs";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/ofetch/dist/node.mjs";
import "#internal/nuxt/paths";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/unctx/dist/index.mjs";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/h3/dist/index.mjs";
import "vue-router";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/radix3/dist/index.mjs";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/defu/dist/defu.mjs";
import "/Users/andrejbelaev/Desktop/Проекты/Max-app/max-channels/node_modules/ufo/dist/index.mjs";
import "vue/server-renderer";
const admin = defineNuxtRouteMiddleware((to) => {
  let token;
  {
    const event = useRequestEvent();
    const cookies = event?.req?.headers?.cookie || "";
    token = cookies.split(";").map((c) => c.trim()).find((c) => c.startsWith("accessToken="))?.split("=")[1] ?? void 0;
  }
  console.log("token", token);
  if (!token) return navigateTo("/");
  try {
    const decoded = jwtDecode(token);
    if (decoded.role !== "ADMIN") return navigateTo("/");
  } catch (e) {
    return navigateTo("/");
  }
});
export {
  admin as default
};
//# sourceMappingURL=admin-D9Fj1_Sf.js.map
