{"version":3,"file":"admin-B_7SiB7i.js","sources":["../../../../../../../middleware/admin.ts"],"sourcesContent":["// middleware/admin.global.ts\nimport { jwtDecode } from \"jwt-decode\";\n\nexport default defineNuxtRouteMiddleware((to) => {\n  const token = useCookie(\"accessToken\");\n\n  if (!token.value) {\n    console.log(\"[ADMIN MIDDLEWARE] Нет токена, редирект на /\");\n    return navigateTo(\"/\");\n  }\n\n  try {\n    const decoded = jwtDecode<{ role?: string }>(token.value);\n    console.log(\"[ADMIN MIDDLEWARE] Декодированный токен:\", decoded);\n\n    if (decoded.role !== \"ADMIN\") {\n      console.log(\"[ADMIN MIDDLEWARE] Роль не ADMIN, редирект на /\");\n      return navigateTo(\"/\");\n    }\n\n  } catch (e) {\n    console.error(\"[ADMIN MIDDLEWARE] Ошибка парсинга токена:\", e);\n    return navigateTo(\"/\");\n  }\n});\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAGA,MAAA,QAAe,0BAA0B,CAAC,OAAO;AAC/C,QAAM,QAAQ,UAAU,aAAa;AAErC,MAAI,CAAC,MAAM,OAAO;AAChB,YAAQ,IAAI,8CAA8C;AAC1D,WAAO,WAAW,GAAG;AAAA,EACvB;AAEA,MAAI;AACF,UAAM,UAAU,UAA6B,MAAM,KAAK;AACxD,YAAQ,IAAI,4CAA4C,OAAO;AAE/D,QAAI,QAAQ,SAAS,SAAS;AAC5B,cAAQ,IAAI,iDAAiD;AAC7D,aAAO,WAAW,GAAG;AAAA,IACvB;AAAA,EAEF,SAAS,GAAG;AACV,YAAQ,MAAM,8CAA8C,CAAC;AAC7D,WAAO,WAAW,GAAG;AAAA,EACvB;AACF,CAAC;"}