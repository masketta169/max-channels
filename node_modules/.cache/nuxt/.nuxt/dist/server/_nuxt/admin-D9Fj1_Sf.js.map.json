{"file":"admin-D9Fj1_Sf.js","mappings":";;;;;;;;;;;;;;AAEA,MAAA,QAAe,0BAA0B,CAAC,OAAO;AAC/C,MAAI;AAEgB;AAClB,UAAM,QAAQ,gBAAA;AACd,UAAM,UAAU,OAAO,KAAK,SAAS,UAAU;AAC/C,YAAQ,QACL,MAAM,GAAG,EACT,IAAI,CAAA,MAAK,EAAE,MAAM,EACjB,KAAK,CAAA,MAAK,EAAE,WAAW,cAAc,CAAC,GACrC,MAAM,GAAG,EAAE,CAAC,KAAK;AAAA,EACvB;AAIA,UAAQ,IAAI,SAAS,KAAK;AAE1B,MAAI,CAAC,MAAO,QAAO,WAAW,GAAG;AAEjC,MAAI;AACF,UAAM,UAAU,UAA6B,KAAK;AAClD,QAAI,QAAQ,SAAS,QAAS,QAAO,WAAW,GAAG;AAAA,EACrD,SAAS,GAAG;AACV,WAAO,WAAW,GAAG;AAAA,EACvB;AACF,CAAC;","names":[],"sources":["../../../../../../../middleware/admin.ts"],"sourcesContent":["import { jwtDecode } from 'jwt-decode'\n\nexport default defineNuxtRouteMiddleware((to) => {\n  let token: string | undefined;\n\n  if (process.server) {\n    const event = useRequestEvent();\n    const cookies = event?.req?.headers?.cookie || '';\n    token = cookies\n      .split(';')\n      .map(c => c.trim())\n      .find(c => c.startsWith('accessToken='))\n      ?.split('=')[1] ?? undefined;\n  } else {\n    token = useCookie('accessToken').value ?? undefined;\n  }\n\n  console.log('token', token);\n\n  if (!token) return navigateTo('/');\n\n  try {\n    const decoded = jwtDecode<{ role?: string }>(token);\n    if (decoded.role !== 'ADMIN') return navigateTo('/');\n  } catch (e) {\n    return navigateTo('/');\n  }\n});\n"],"version":3}