import{H as D,r as I,I as $,J as O,K as T,L as U,M as R,N,n as v}from"./D_ksBAuK.js";function A(t){return typeof t=="string"?`'${t}'`:new M().serialize(t)}const M=(function(){class t{#e=new Map;compare(e,r){const i=typeof e,a=typeof r;return i==="string"&&a==="string"?e.localeCompare(r):i==="number"&&a==="number"?e-r:String.prototype.localeCompare.call(this.serialize(e,!0),this.serialize(r,!0))}serialize(e,r){if(e===null)return"null";switch(typeof e){case"string":return r?e:`'${e}'`;case"bigint":return`${e}n`;case"object":return this.$object(e);case"function":return this.$function(e)}return String(e)}serializeObject(e){const r=Object.prototype.toString.call(e);if(r!=="[object Object]")return this.serializeBuiltInType(r.length<10?`unknown:${r}`:r.slice(8,-1),e);const i=e.constructor,a=i===Object||i===void 0?"":i.name;if(a!==""&&globalThis[a]===i)return this.serializeBuiltInType(a,e);if(typeof e.toJSON=="function"){const o=e.toJSON();return a+(o!==null&&typeof o=="object"?this.$object(o):`(${this.serialize(o)})`)}return this.serializeObjectEntries(a,Object.entries(e))}serializeBuiltInType(e,r){const i=this["$"+e];if(i)return i.call(this,r);if(typeof r?.entries=="function")return this.serializeObjectEntries(e,r.entries());throw new Error(`Cannot serialize ${e}`)}serializeObjectEntries(e,r){const i=Array.from(r).sort((o,s)=>this.compare(o[0],s[0]));let a=`${e}{`;for(let o=0;o<i.length;o++){const[s,c]=i[o];a+=`${this.serialize(s,!0)}:${this.serialize(c)}`,o<i.length-1&&(a+=",")}return a+"}"}$object(e){let r=this.#e.get(e);return r===void 0&&(this.#e.set(e,`#${this.#e.size}`),r=this.serializeObject(e),this.#e.set(e,r)),r}$function(e){const r=Function.prototype.toString.call(e);return r.slice(-15)==="[native code] }"?`${e.name||""}()[native]`:`${e.name}(${e.length})${r.replace(/\s*\n\s*/g,"")}`}$Array(e){let r="[";for(let i=0;i<e.length;i++)r+=this.serialize(e[i]),i<e.length-1&&(r+=",");return r+"]"}$Date(e){try{return`Date(${e.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(e){return`ArrayBuffer[${new Uint8Array(e).join(",")}]`}$Set(e){return`Set${this.$Array(Array.from(e).sort((r,i)=>this.compare(r,i)))}`}$Map(e){return this.serializeObjectEntries("Map",e.entries())}}for(const n of["Error","RegExp","URL"])t.prototype["$"+n]=function(e){return`${n}(${e})`};for(const n of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])t.prototype["$"+n]=function(e){return`${n}[${e.join(",")}]`};for(const n of["BigInt64Array","BigUint64Array"])t.prototype["$"+n]=function(e){return`${n}[${e.join("n,")}${e.length>0?"n":""}]`};return t})();function x(t,n){return t===n||A(t)===A(n)}function B(t,n){if(typeof t!="string")throw new TypeError("argument str must be a string");const e={},r=n||{},i=r.decode||L;let a=0;for(;a<t.length;){const o=t.indexOf("=",a);if(o===-1)break;let s=t.indexOf(";",a);if(s===-1)s=t.length;else if(s<o){a=t.lastIndexOf(";",o-1)+1;continue}const c=t.slice(a,o).trim();if(r?.filter&&!r?.filter(c)){a=s+1;continue}if(e[c]===void 0){let l=t.slice(o+1,s).trim();l.codePointAt(0)===34&&(l=l.slice(1,-1)),e[c]=P(l,i)}a=s+1}return e}function L(t){return t.includes("%")?decodeURIComponent(t):t}function P(t,n){try{return n(t)}catch{return t}}const w=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function j(t,n,e){const r=e||{},i=r.encode||encodeURIComponent;if(typeof i!="function")throw new TypeError("option encode is invalid");if(!w.test(t))throw new TypeError("argument name is invalid");const a=i(n);if(a&&!w.test(a))throw new TypeError("argument val is invalid");let o=t+"="+a;if(r.maxAge!==void 0&&r.maxAge!==null){const s=r.maxAge-0;if(Number.isNaN(s)||!Number.isFinite(s))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(s)}if(r.domain){if(!w.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain="+r.domain}if(r.path){if(!w.test(r.path))throw new TypeError("option path is invalid");o+="; Path="+r.path}if(r.expires){if(!_(r.expires)||Number.isNaN(r.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():r.priority){case"low":{o+="; Priority=Low";break}case"medium":{o+="; Priority=Medium";break}case"high":{o+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:{o+="; SameSite=Strict";break}case"lax":{o+="; SameSite=Lax";break}case"strict":{o+="; SameSite=Strict";break}case"none":{o+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return r.partitioned&&(o+="; Partitioned"),o}function _(t){return Object.prototype.toString.call(t)==="[object Date]"||t instanceof Date}function u(t){if(typeof t!="object")return t;var n,e,r=Object.prototype.toString.call(t);if(r==="[object Object]"){if(t.constructor!==Object&&typeof t.constructor=="function"){e=new t.constructor;for(n in t)t.hasOwnProperty(n)&&e[n]!==t[n]&&(e[n]=u(t[n]))}else{e={};for(n in t)n==="__proto__"?Object.defineProperty(e,n,{value:u(t[n]),configurable:!0,enumerable:!0,writable:!0}):e[n]=u(t[n])}return e}if(r==="[object Array]"){for(n=t.length,e=Array(n);n--;)e[n]=u(t[n]);return e}return r==="[object Set]"?(e=new Set,t.forEach(function(i){e.add(u(i))}),e):r==="[object Map]"?(e=new Map,t.forEach(function(i,a){e.set(u(a),u(i))}),e):r==="[object Date]"?new Date(+t):r==="[object RegExp]"?(e=new RegExp(t.source,t.flags),e.lastIndex=t.lastIndex,e):r==="[object DataView]"?new t.constructor(u(t.buffer)):r==="[object ArrayBuffer]"?t.slice(0):r.slice(-6)==="Array]"?new t.constructor(t):t}const F={path:"/",watch:!0,decode:t=>D(decodeURIComponent(t)),encode:t=>encodeURIComponent(typeof t=="string"?t:JSON.stringify(t))},m=window.cookieStore;function J(t,n){const e={...F,...n};e.filter??=l=>l===t;const r=E(e)||{};let i;e.maxAge!==void 0?i=e.maxAge*1e3:e.expires&&(i=e.expires.getTime()-Date.now());const a=i!==void 0&&i<=0,o=a||r[t]===void 0||r[t]===null,s=u(a?void 0:r[t]??e.default?.()),c=i&&!a?q(s,i,e.watch&&e.watch!=="shallow"):I(s);{let l=null;try{!m&&typeof BroadcastChannel<"u"&&(l=new BroadcastChannel(`nuxt:cookies:${t}`))}catch{}const p=(f=!1)=>{!f&&(e.readonly||x(c.value,r[t]))||(V(t,c.value,e),r[t]=u(c.value),l?.postMessage({value:e.encode(c.value)}))},d=f=>{const h=f.refresh?E(e)?.[t]:e.decode(f.value);g=!0,c.value=h,r[t]=u(h),R(()=>{g=!1})};let g=!1;const k=!!T();if(k&&$(()=>{g=!0,p(),l?.close()}),m){const f=h=>{const S=h.changed.find(b=>b.name===t),z=h.deleted.find(b=>b.name===t);S&&d({value:S.value}),z&&d({value:null})};m.addEventListener("change",f),k&&$(()=>m.removeEventListener("change",f))}else l&&(l.onmessage=({data:f})=>d(f));e.watch&&O(c,()=>{g||p()},{deep:e.watch!=="shallow"}),o&&p(o)}return c}function E(t={}){return B(document.cookie,t)}function H(t,n,e={}){return n==null?j(t,n,{...e,maxAge:-1}):j(t,n,e)}function V(t,n,e={}){document.cookie=H(t,n,e)}const C=2147483647;function q(t,n,e){let r,i,a=0;const o=e?I(t):{value:t};return T()&&$(()=>{i?.(),clearTimeout(r)}),U((s,c)=>{e&&(i=O(o,c));function l(){a=0,clearTimeout(r);const p=n-a,d=p<C?p:C;r=setTimeout(()=>{if(a+=d,a<n)return l();o.value=void 0,c()},d)}return{get(){return s(),o.value},set(p){l(),o.value=p,c()}}})}class y extends Error{}y.prototype.name="InvalidTokenError";function K(t){return decodeURIComponent(atob(t).replace(/(.)/g,(n,e)=>{let r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function X(t){let n=t.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return K(n)}catch{return atob(n)}}function Y(t,n){if(typeof t!="string")throw new y("Invalid token specified: must be a string");n||(n={});const e=n.header===!0?0:1,r=t.split(".")[e];if(typeof r!="string")throw new y(`Invalid token specified: missing part #${e+1}`);let i;try{i=X(r)}catch(a){throw new y(`Invalid token specified: invalid base64 for part #${e+1} (${a.message})`)}try{return JSON.parse(i)}catch(a){throw new y(`Invalid token specified: invalid json for part #${e+1} (${a.message})`)}}const Q=N(t=>{let n;if(n=J("accessToken").value??void 0,console.log("token",n),!n)return v("/");try{if(Y(n).role!=="ADMIN")return v("/")}catch{return v("/")}});export{Q as default};
